(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){factory(require('jquery'));}else{factory(jQuery);}}(function($){var cookie_local_prefix="ls_";var cookie_session_prefix="ss_";function _get(){var storage=this._type,l=arguments.length,s=window[storage],a=arguments,a0=a[0],vi,ret,tmp;if(l<1){throw new Error('Minimum 1 argument must be given');}else if($.isArray(a0)){ret={};for(var i in a0){vi=a0[i];try{ret[vi]=JSON.parse(s.getItem(vi));}catch(e){ret[vi]=s.getItem(vi);}}return ret;}else if(l==1){try{return JSON.parse(s.getItem(a0));}catch(e){return s.getItem(a0);}}else{try{ret=JSON.parse(s.getItem(a0));}catch(e){throw new ReferenceError(a0+' is not defined in this storage');}for(var i=1;i<l-1;i++){ret=ret[a[i]];if(ret===undefined){throw new ReferenceError([].slice.call(a,1,i+1).join('.')+' is not defined in this storage');}}if($.isArray(a[i])){tmp=ret;ret={};for(var j in a[i]){ret[a[i][j]]=tmp[a[i][j]];}return ret;}else{return ret[a[i]];}}}function _set(){var storage=this._type,l=arguments.length,s=window[storage],a=arguments,a0=a[0],a1=a[1],vi,to_store=isNaN(a1)?{}:[],type,tmp;if(l<1||!$.isPlainObject(a0)&&l<2){throw new Error('Minimum 2 arguments must be given or first parameter must be an object');}else if($.isPlainObject(a0)){for(var i in a0){vi=a0[i];if(!$.isPlainObject(vi)&&!this.alwaysUseJson){s.setItem(i,vi);}else{s.setItem(i,JSON.stringify(vi));}}return a0;}else if(l==2){if(typeof a1==='object'||this.alwaysUseJson){s.setItem(a0,JSON.stringify(a1));}else{s.setItem(a0,a1);}return a1;}else{try{tmp=s.getItem(a0);if(tmp!=null){to_store=JSON.parse(tmp);}}catch(e){}tmp=to_store;for(var i=1;i<l-2;i++){vi=a[i];type=isNaN(a[i+1])?"object":"array";if(!tmp[vi]||type=="object"&&!$.isPlainObject(tmp[vi])||type=="array"&&!$.isArray(tmp[vi])){if(type=="array")tmp[vi]=[];else tmp[vi]={};}tmp=tmp[vi];}tmp[a[i]]=a[i+1];s.setItem(a0,JSON.stringify(to_store));return to_store;}}function _remove(){var storage=this._type,l=arguments.length,s=window[storage],a=arguments,a0=a[0],to_store,tmp;if(l<1){throw new Error('Minimum 1 argument must be given');}else if($.isArray(a0)){for(var i in a0){s.removeItem(a0[i]);}return true;}else if(l==1){s.removeItem(a0);return true;}else{try{to_store=tmp=JSON.parse(s.getItem(a0));}catch(e){throw new ReferenceError(a0+' is not defined in this storage');}for(var i=1;i<l-1;i++){tmp=tmp[a[i]];if(tmp===undefined){throw new ReferenceError([].slice.call(a,1,i).join('.')+' is not defined in this storage');}}if($.isArray(a[i])){for(var j in a[i]){delete tmp[a[i][j]];}}else{delete tmp[a[i]];}s.setItem(a0,JSON.stringify(to_store));return true;}}function _removeAll(reinit_ns){var keys=_keys.call(this);for(var i in keys){_remove.call(this,keys[i]);}if(reinit_ns){for(var i in $.namespaceStorages){_createNamespace(i);}}}function _isEmpty(){var l=arguments.length,a=arguments,a0=a[0];if(l==0){return(_keys.call(this).length==0);}else if($.isArray(a0)){for(var i=0;i<a0.length;i++){if(!_isEmpty.call(this,a0[i])){return false;}}return true;}else{try{var v=_get.apply(this,arguments);if(!$.isArray(a[l-1])){v={'totest':v};}for(var i in v){if(!(($.isPlainObject(v[i])&&$.isEmptyObject(v[i]))||($.isArray(v[i])&&!v[i].length)||(!v[i]))){return false;}}return true;}catch(e){return true;}}}function _isSet(){var l=arguments.length,a=arguments,a0=a[0];if(l<1){throw new Error('Minimum 1 argument must be given');}if($.isArray(a0)){for(var i=0;i<a0.length;i++){if(!_isSet.call(this,a0[i])){return false;}}return true;}else{try{var v=_get.apply(this,arguments);if(!$.isArray(a[l-1])){v={'totest':v};}for(var i in v){if(!(v[i]!==undefined&&v[i]!==null)){return false;}}return true;}catch(e){return false;}}}function _keys(){var storage=this._type,l=arguments.length,s=window[storage],a=arguments,keys=[],o={};if(l>0){o=_get.apply(this,a);}else{o=s;}if(o&&o._cookie){for(var key in Cookies.get()){if(key!=''){keys.push(key.replace(o._prefix,''));}}}else{for(var i in o){if(o.hasOwnProperty(i)){keys.push(i);}}}return keys;}function _createNamespace(name){if(!name||typeof name!="string"){throw new Error('First parameter must be a string');}if(storage_available){if(!window.localStorage.getItem(name)){window.localStorage.setItem(name,'{}');}if(!window.sessionStorage.getItem(name)){window.sessionStorage.setItem(name,'{}');}}else{if(!window.localCookieStorage.getItem(name)){window.localCookieStorage.setItem(name,'{}');}if(!window.sessionCookieStorage.getItem(name)){window.sessionCookieStorage.setItem(name,'{}');}}var ns={localStorage:$.extend({},$.localStorage,{_ns:name}),sessionStorage:$.extend({},$.sessionStorage,{_ns:name})};if(typeof Cookies!=='undefined'){if(!window.cookieStorage.getItem(name)){window.cookieStorage.setItem(name,'{}');}ns.cookieStorage=$.extend({},$.cookieStorage,{_ns:name});}$.namespaceStorages[name]=ns;return ns;}function _testStorage(name){var foo='jsapi';try{if(!window[name]){return false;}window[name].setItem(foo,foo);window[name].removeItem(foo);return true;}catch(e){return false;}}var storage_available=_testStorage('localStorage');var storage={_type:'',_ns:'',_callMethod:function(f,a){var p=[],a=Array.prototype.slice.call(a),a0=a[0];if(this._ns){p.push(this._ns);}if(typeof a0==='string'&&a0.indexOf('.')!==-1){a.shift();[].unshift.apply(a,a0.split('.'));}[].push.apply(p,a);return f.apply(this,p);},alwaysUseJson:false,get:function(){return this._callMethod(_get,arguments);},set:function(){var l=arguments.length,a=arguments,a0=a[0];if(l<1||!$.isPlainObject(a0)&&l<2){throw new Error('Minimum 2 arguments must be given or first parameter must be an object');}if($.isPlainObject(a0)&&this._ns){for(var i in a0){this._callMethod(_set,[i,a0[i]]);}return a0;}else{var r=this._callMethod(_set,a);if(this._ns){return r[a0.split('.')[0]];}else{return r;}}},remove:function(){if(arguments.length<1){throw new Error('Minimum 1 argument must be given');}return this._callMethod(_remove,arguments);},removeAll:function(reinit_ns){if(this._ns){this._callMethod(_set,[{}]);return true;}else{return this._callMethod(_removeAll,[reinit_ns]);}},isEmpty:function(){return this._callMethod(_isEmpty,arguments);},isSet:function(){if(arguments.length<1){throw new Error('Minimum 1 argument must be given');}return this._callMethod(_isSet,arguments);},keys:function(){return this._callMethod(_keys,arguments);}};if(typeof Cookies!=='undefined'){if(!window.name){window.name=Math.floor(Math.random()*100000000);}var cookie_storage={_cookie:true,_prefix:'',_expires:null,_path:null,_domain:null,setItem:function(n,v){Cookies.set(this._prefix+n,v,{expires:this._expires,path:this._path,domain:this._domain});},getItem:function(n){return Cookies.get(this._prefix+n);},removeItem:function(n){return Cookies.remove(this._prefix+n,{path:this._path});},clear:function(){for(var key in Cookies.get()){if(key!=''){if(!this._prefix&&key.indexOf(cookie_local_prefix)===-1&&key.indexOf(cookie_session_prefix)===-1||this._prefix&&key.indexOf(this._prefix)===0){Cookies.remove(key);}}}},setExpires:function(e){this._expires=e;return this;},setPath:function(p){this._path=p;return this;},setDomain:function(d){this._domain=d;return this;},setConf:function(c){if(c.path){this._path=c.path;}if(c.domain){this._domain=c.domain;}if(c.expires){this._expires=c.expires;}return this;},setDefaultConf:function(){this._path=this._domain=this._expires=null;}};if(!storage_available){window.localCookieStorage=$.extend({},cookie_storage,{_prefix:cookie_local_prefix,_expires:365*10});window.sessionCookieStorage=$.extend({},cookie_storage,{_prefix:cookie_session_prefix+window.name+'_'});}window.cookieStorage=$.extend({},cookie_storage);$.cookieStorage=$.extend({},storage,{_type:'cookieStorage',setExpires:function(e){window.cookieStorage.setExpires(e);return this;},setPath:function(p){window.cookieStorage.setPath(p);return this;},setDomain:function(d){window.cookieStorage.setDomain(d);return this;},setConf:function(c){window.cookieStorage.setConf(c);return this;},setDefaultConf:function(){window.cookieStorage.setDefaultConf();return this;}});}$.initNamespaceStorage=function(ns){return _createNamespace(ns);};if(storage_available){$.localStorage=$.extend({},storage,{_type:'localStorage'});$.sessionStorage=$.extend({},storage,{_type:'sessionStorage'});}else{$.localStorage=$.extend({},storage,{_type:'localCookieStorage'});$.sessionStorage=$.extend({},storage,{_type:'sessionCookieStorage'});}$.namespaceStorages={};$.removeAllStorages=function(reinit_ns){$.localStorage.removeAll(reinit_ns);$.sessionStorage.removeAll(reinit_ns);if($.cookieStorage){$.cookieStorage.removeAll(reinit_ns);}if(!reinit_ns){$.namespaceStorages={};}}
$.alwaysUseJsonInStorage=function(value){storage.alwaysUseJson=value;$.localStorage.alwaysUseJson=value;$.sessionStorage.alwaysUseJson=value;if($.cookieStorage){$.cookieStorage.alwaysUseJson=value;}}}));